import{b as x,j as e,M as b,t as y,B as g}from"./index-C-3fXsNk.js";function j({openModal:r,setOpenModal:n,userReport:c}){const[l,m]=x.useState(Array(c.length).fill(!1)),p=o=>{m(s=>{const i=[...s];return i[o]=!i[o],i})};return e.jsx(e.Fragment,{children:e.jsxs(b,{show:r,onClose:()=>n(!1),userReport:c,children:[e.jsx(b.Header,{className:"bg-gray-800",children:e.jsx("h1",{className:"text-white font-bold",children:"User Reports"})}),e.jsx(b.Body,{className:"ring-1 bg-background rounded-b-md px-2 py-2",children:(c==null?void 0:c.length)===0?e.jsx(e.Fragment,{children:e.jsx("h1",{className:"text-white",children:"No Reports for this User"})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full",children:c==null?void 0:c.map((o,s)=>e.jsxs("div",{id:`accordion-collapse-${s}`,"data-accordion":"collapse",children:[e.jsx("h2",{id:`accordion-collapse-heading-${s}`,children:e.jsxs("button",{type:"button",className:"flex items-center justify-between w-full p-5 font-medium rtl:text-right text-gray-500 border border-b-0 border-gray-600 rounded-t-xl dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-800 gap-3","data-accordion-target":`#accordion-collapse-body-${s}`,"aria-expanded":l[s],"aria-controls":`accordion-collapse-body-${s}`,onClick:()=>p(s),children:[e.jsxs("span",{className:"text-text text-lg",children:["Report ",s+1]}),e.jsx("svg",{"data-accordion-icon":!0,className:`w-3 h-3 rotate-180 shrink-0 ${l[s]?"rotate-180":""}`,"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5 5 1 1 5"})})]})}),e.jsx("div",{id:`accordion-collapse-body-${s}`,className:l[s]?"block":"hidden","aria-labelledby":`accordion-collapse-heading-${s}`,children:e.jsx("div",{className:"p-5 border border-b-0 border-gray-600 dark:border-gray-700 dark:bg-gray-900",children:e.jsx("p",{className:"mb-2 text-text dark:text-gray-400",children:o==null?void 0:o.reason})})})]},s))})})})]})})}const k=async()=>{try{return(await y.get("/admin/users",{withCredentials:!0})).data}catch(r){return r}},N=async r=>{try{return(await y.put(`/admin/users/block/${r}`,{withCredentials:!0})).data}catch(n){return n}},f=async r=>{try{return(await y.put(`/admin/users/unblock/${r}`,{withCredentials:!0})).data}catch(n){return n}};function u(){const[r,n]=x.useState(!1),[c,l]=x.useState([]),[m,p]=x.useState([]),o=a=>{const t=c.find(h=>h._id===a);p(t.reports),n(!0)};x.useEffect(()=>{(async()=>{const t=await k();t.success===!0&&l(t==null?void 0:t.userList)})()},[n,l,p,m,r]);const s=async a=>{const t=await N(a);if((t==null?void 0:t.success)===!0){const h=c.map(d=>d._id===a?{...d,is_blocked:!0}:d);l(h),g(t==null?void 0:t.message)}},i=async a=>{const t=await f(a);if((t==null?void 0:t.success)===!0){const h=c.map(d=>d._id===a?{...d,is_blocked:!1}:d);l(h),g(t==null?void 0:t.message)}};return e.jsxs(e.Fragment,{children:[e.jsx(j,{openModal:r,setOpenModal:n,userReport:m}),e.jsx("div",{className:" h-screen bg-background",children:e.jsx("div",{className:"col-span-9",children:e.jsxs("div",{className:"text-text",children:[e.jsx("h1",{className:"text-2xl py-12",children:"User Managment"}),e.jsx("div",{children:e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right rounded",children:[e.jsx("thead",{className:"text-xs bg-secondary rounded",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-primary",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-primary",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-primary",children:"Reports"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-primary",children:"View Reports"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-primary",children:"Block/Unblock"})]})}),c==null?void 0:c.map((a,t)=>e.jsx(e.Fragment,{children:e.jsx("tbody",{children:e.jsxs("tr",{className:"border-b border-gray-600",children:[e.jsx("th",{scope:"row",className:"px-6 py-4 font-medium",children:a==null?void 0:a.fullname}),e.jsx("td",{className:"px-6 py-4",children:a==null?void 0:a.email}),e.jsx("td",{className:"px-6 py-4",children:a==null?void 0:a.reports.length}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{className:"border border-gray-600 bg-gray-700 py-1 px-6 rounded",onClick:()=>o(a==null?void 0:a._id),children:"View"})}),e.jsx("td",{className:"px-6 py-4",children:a!=null&&a.is_blocked?e.jsx("button",{className:"border py-1 px-4 rounded hover:bg-green-700",onClick:()=>i(a==null?void 0:a._id),children:"UnBlock"}):e.jsx("button",{className:"border py-1 px-6 rounded hover:bg-red-700",onClick:()=>s(a==null?void 0:a._id),children:"Block"})})]})},t)}))]})})]})})})]})}export{u as default};
